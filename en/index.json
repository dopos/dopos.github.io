[{"content":"dopos/dcape Docker-compose application environment\nDcape is a tool which helps to create environments for docker-applications deployment using GitOps technology. Dcape based on make and docker-compose and intended to solve the following tasks:\nusing make up run applications which needs shared port (ex. 80) database using git push deploy applications remotely on single or several computers manage app configs through API or web-interface limit via given user group access to used applications interfaces support for letsencrypt wildcard-domains manage docker objects Applications For solving of above-mentioned tasks dcape uses docker-images of the following applications:\nshared port - traefik database - postgresql deploy applications remotely - drone (on every computer) and gitea on someone manage app configs - enfist limit access - narra, gitea organization used as user group wildcard-domains - powerdns manage docker objects - portainer Documentation See dopos.github.io/dcape\nDependensies linux docker sudo apt -y install git make sed curl jq Usage examples Deploy app local Requirements:\nlinux computer with docker and dcape hostnames registered in /etc/hosts or internal DNS (for example - mysite.dev.test, www.mysite.dev.test) pointing to this computer Static site with nginx 1 2 3 4 5 6 $ git clone https://github.com/dopos/dcape-app-nginx-sample.git .. $ cd dcape-app-nginx-sample $ make init up APP_SITE=mysite.dev.test .. Creating mysite-dev-lan_www_1 ... done That\u0026rsquo;s all - http://mysite.dev.test/ and http://www.mysite.dev.test/ are working.\nInstall dcape without gitea Requirements:\nlinux computer with docker and dependensies installed DNS records for wildcard-domain *.srv1.domain.tld Gitea $AUTH_TOKEN created 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 MY_HOST=${MY_HOST:-srv1.domain.tld} MY_IP=${MY_IP:-192.168.23.10} LE_ADMIN=${LE_ADMIN:-admin@domain.tld} GITEA_URL=${GITEA_URL:-https://git.domain.tld} GITEA_ORG=${GITEA_ORG:-dcape} GITEA_USER=${GITEA_USER:-dcapeadmin} $ git clone https://github.com/dopos/dcape.git .. $ cd dcape $ make install ACME=wild DNS=wild DCAPE_DOMAIN=${MY_HOST} \\ TRAEFIK_ACME_EMAIL=${LE_ADMIN} \\ NARRA_GITEA_ORG=${GITEA_ORG} \\ DRONE_ADMIN=${GITEA_USER} \\ PDNS_LISTEN=${MY_IP}:53 \\ GITEA=${GITEA_URL} \\ AUTH_TOKEN=${TOKEN} .. Running dc command: up -d db powerdns traefik narra enfist drone portainer Dcape URL: https://srv1.domain.tld ------------------------------------------ Creating network \u0026#34;dcape\u0026#34; with driver \u0026#34;bridge\u0026#34; Creating dcape_narra_1 ... done Creating dcape_db_1 ... done Creating dcape_drone-compose_1 ... done Creating dcape_portainer_1 ... done Creating dcape_traefik_1 ... done Creating dcape_drone-rd_1 ... done Creating dcape_drone_1 ... done Creating dcape_powerdns_1 ... done Creating dcape_enfist_1 ... done That\u0026rsquo;s all - server srv1.domain.tld ready for apps deployment, used dcape applications are accessible via https://srv1.domain.tld.\n","description":"","id":0,"section":"dcape","tags":null,"title":"Core","uri":"https://dopos.github.io/en/dcape/core/"},{"content":" The format is based on Keep a Changelog\nand this project adheres to Semantic Versioning.\n[3.1.0] - 2024-05-27 Added compare local app versions with upstream \u0026amp; update local (make ver-cmp [ VER_UPDATE=yes]) debug for gitea exchange (including POST debug) Fixed APPS recurse CICD_ADMIN empty AUTH_URL, DCAPE_ADMIN_USER read APP_ROOT from .env standalone .config-link \u0026lsquo;version\u0026rsquo; is obsolete copyright years [3.0.2] - 2023-12-18 Added docs: Upgrade dcape v2 to v3 CHANGELOG.md DCAPE_NET_EXISTS DB_CONTAINER for apps ENFIST_BRANCH APP_ROOT_OPTS, .build Fixed host mount for cicd deploy\nnot use .env in build\npsql-local for app\ndev.lan -\u0026gt; dev.test\nimprove Serve flow\n.default-deploy improved\nhost mount for cicd deploy\npsql-local for app\ngrep .env if var not global\nupd: upgrade-v3, docs\nupd: dev.lan -\u0026gt; dev.test\nUpgrade git pull make git-pull make config-if mv .dcape.env.sample .dcape.env set DCAPE_NET_EXISTS=true make .env make build-compose make up [3.0.0] - 2023-08-01 Changed Move to docker compose plugin Replaced drone with woodpecker Separated core apps repos and configs, see dcape3-coreapp Improve dcape-app [2.2.1] - 2023-06-21 Fixed set HTTP_PROTO after include add PG_ADMIN var rm double labels add timezone psql-local via DSN [2.1.2] - 2022-03-30 Bump docker images:\ntraefik:2.6.2 gitea/gitea:1.16.5 drone/drone:2.11.1 drone/drone-runner-docker:1.8.0 portainer/portainer-ce:2.11.1-alpine ghcr.io/dopos/powerdns-alpine:v4.6.1 [2.1.1] - 2021-11-27 Fixed drone pipelines for non-amd64 drone runners postgresql backups: try .tar before .tgz support for docker-compose v1.28+ Upgrade git pull mv .env .env.bak make init make up [2.1.0] - 2021-11-17 Added own docker images placed at ghcr.io support for arm64 arch updated third-party apps versions [2.0.0] - 2021-01-28 own docker images placed at ghcr.io added support for arm64 arch updated third-party apps versions [1.1] - 2020-11-16 2 years in prod [1.0.0-rc2] - 2018-09-23 Изменено apps/enfist: вместо pgrpc-sql-enfist теперь используется apisite Установка обновления 1 2 3 4 5 git pull mv .env .env.bak make init make enfist-apply make up [1.0.0-rc1] - 2017-10-22 Изменено apps/traefik*: в настройки вынесен редирект 80 -\u0026gt; 443 apps/traefik теперь не совместим по конфигу с apps/traefik-acme, при переключении необходим make init apps/cis: добавлено создание каталогов var/apps, var/log в cis-apply apps/cis: изменена версия webtail (0.12) apps/enfist: исправлено обновление sql-пакетов enfist,rpc и их текущие версии Добавлено Файл CHANGELOG.md README.md: информация о зависимости (gawk), уточнен блок \u0026ldquo;Быстрый старт\u0026rdquo; DEPLOY.md: блоки \u0026ldquo;Информация для разработчика\u0026rdquo;, \u0026ldquo;Удаление деплоя\u0026rdquo; Makefile: поддержка параметров PG_PORT_LOCAL, CFG_BAK Установка обновления 1 2 3 4 5 6 7 8 9 10 git pull mv .env .env.bak make init # Тут будет предупреждение об устаревшей версии webtail - надо изменить на новую в .env make enfist-apply # Сообщения \u0026#34;ERROR: Newest lib version (0.1) loaded already\u0026#34; игнорируем, других ошибок быть не должно make dc CMD=\u0026#34;up -d webtail\u0026#34; [0.1] - 2017-08-11 Move to dcape project, code working in general, commit\n[0.0.2] - 2015-02-12 Github: fidm Commit: init Last commit: 2018-08-15 Начало разработки аналога fig, утилиты для управления контейнерами Docker, которая была доступна на сайте fig.sh.\n[0.0.1] - 2014-11-12 Github: consup Commit: init Last commit: 2017-09-27 Начало работ по построению решения для автоматизации использования контейнеров docker.\n","description":"","id":1,"section":"dcape","tags":null,"title":"ChangeLog","uri":"https://dopos.github.io/en/dcape/changelog/"}]